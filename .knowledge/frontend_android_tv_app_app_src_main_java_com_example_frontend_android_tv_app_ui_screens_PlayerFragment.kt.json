{"is_source_file": true, "format": "Kotlin", "description": "This file defines a PlayerFragment class which manages video playback, UI overlays, subtitle handling, keyboard controls, autoplay features, and user interactions for an Android TV application. It integrates with ExoPlayer and handles various media and UI state logic.", "external_files": ["androidx.media3.common.MediaItem", "androidx.media3.common.Player", "androidx.media3.exoplayer.ExoPlayer", "androidx.media3.ui.CaptionStyleCompat", "androidx.media3.ui.PlayerView", "androidx.media3.ui.SubtitleView", "com.bumptech.glide.Glide", "com.example.frontend_android_tv_app.data.FavoritesStore", "com.example.frontend_android_tv_app.data.LastPlayedIndexStore", "com.example.frontend_android_tv_app.data.ProgressStore", "com.example.frontend_android_tv_app.data.SubtitlesRepository", "com.example.frontend_android_tv_app.data.Video", "com.example.frontend_android_tv_app.data.VideoParcelable", "com.example.frontend_android_tv_app.data.VideosRepository", "com.example.frontend_android_tv_app.ui.player.AutoplayCoordinator", "android.os.Bundle", "androidx.core.view.isVisible"], "external_methods": ["VideosRepository.categories", "VideosRepository.videosForCategory", "Video.toParcelable", "VideoParcelable.toVideo", "SubtitlesRepository.tracksForVideo", "SubtitlesRepository.toSubtitleConfiguration", "FavoritesStore.from", "LastPlayedIndexStore.from", "ProgressStore.from", "SubtitleSelectionStore.getSelectedTrackId", "SubtitleSelectionStore.setSelectedTrackId"], "published": ["PlayerFragment", "Player", "AutoplayCoordinator"], "classes": [{"name": "PlayerFragment", "description": "A Fragment that handles video playback, overlays, controls, subtitles, and autoplay logic for a TV app."}], "methods": [{"name": "handleKey", "description": "Handles key events for navigation, playback control, mute, subtitles, and overlays."}, {"name": "togglePlayPause", "description": "Toggles between playing and pausing the video."}, {"name": "updatePlayPauseLabel", "description": "Updates the label of the play/pause button based on current playback state."}, {"name": "seekBy", "description": "Seeks the video playback position by a specified delta (ms)."}, {"name": "changeVolumeBy", "description": "Adjusts the volume by a delta (0.0 to 1.0)."}, {"name": "toggleMute", "description": "Toggles muting the video."}, {"name": "updateVolumeText", "description": "Updates the UI text displaying current volume level."}, {"name": "updateTimeAndProgress", "description": "Updates the current playback time and progress bar."}, {"name": "formatTime", "description": "Formats milliseconds into a MM:SS string."}, {"name": "setOverlayVisible", "description": "Shows or hides the overlay controls."}, {"name": "showOverlayTemporarily", "description": "Shows overlay controls temporarily with auto-hide timer."}, {"name": "scheduleOverlayHide", "description": "Schedules the overlay to hide after delay."}, {"name": "persistProgressIfNeeded", "description": "Saves current playback position unless near end."}, {"name": "startAutoplayFlow", "description": "Initiates autoplay sequence at the end of video, resolving next videos."}, {"name": "resolveRowVideos", "description": "Resolves a list of videos based on row key/ID list for autoplay."}, {"name": "renderNextUpState", "description": "Displays the next-up overlay UI based on autoplay state."}, {"name": "hideNextUpOverlay", "description": "Hides the next-up overlay."}, {"name": "cancelAutoplay", "description": "Cancels the autoplay sequence and resets relevant flags."}, {"name": "playNextUp", "description": "Starts playback of the next video in the autoplay sequence."}, {"name": "buildMediaItemForCurrentVideo", "description": "Constructs a MediaItem for ExoPlayer including subtitles."}, {"name": "configureSubtitleOverlayUi", "description": "Configures and displays subtitle track options in the overlay."}, {"name": "showSubtitleSettingsOverlay", "description": "Displays subtitle track selection overlay."}, {"name": "hideSubtitleSettingsOverlay", "description": "Hides subtitle track selection overlay."}, {"name": "applySubtitleSelectionByIndex", "description": "Applies subtitle track selection based on list index."}, {"name": "applySubtitleSelection", "description": "Sets the active subtitle track in the player."}, {"name": "toggleSubtitlesQuick", "description": "Quick toggle subtitles on/off."}], "calls": ["buildMediaItemForCurrentVideo", "player?.seekTo", "player?.pause", "player?.play", "player?.setMediaItem", "player?.prepare", "player?.trackSelectionParameters", "player?.setTrackSelectionParameters", "Glide.with", "cancelAutoplay", "hideNextUpOverlay"], "search-terms": ["PlayerFragment", "ExoPlayer", "SubtitleTrack", "Autoplay", "NextUp", "Overlay", "keyboard controls", "seek", "mute", "autoplay on end", "video playback", "TV app"], "state": 2, "file_id": 29, "knowledge_revision": 145, "git_revision": "a2c6db98100f0ce236183e23a803dce7972e5e5f", "revision_history": [{"64": ""}, {"68": ""}, {"77": "8f3bd2a44be0c20c2cdd27771c55251538083b85"}, {"98": "a2c6db98100f0ce236183e23a803dce7972e5e5f"}, {"136": "a2c6db98100f0ce236183e23a803dce7972e5e5f"}, {"143": "a2c6db98100f0ce236183e23a803dce7972e5e5f"}, {"145": "a2c6db98100f0ce236183e23a803dce7972e5e5f"}], "hash": "22befc2f40744c07bce6ea1d4a2a2ea9", "format-version": 4, "code-base-name": "frontend_android_tv_app", "filename": "frontend_android_tv_app/app/src/main/java/com/example/frontend_android_tv_app/ui/screens/PlayerFragment.kt"}