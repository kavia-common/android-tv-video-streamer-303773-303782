{"is_source_file": true, "format": "Kotlin", "description": "This file implements a local-only storage system for tracking video playback progress within an Android application. It defines a class ProgressStore that uses SharedPreferences to persist progress data per video, using JSON serialization. It includes methods for reading, writing, clearing, and listing progress, as well as nested data classes for representing progress states.", "external_files": ["android.content.Context", "android.content.SharedPreferences", "org.json.JSONObject", "kotlin.math.roundToInt"], "external_methods": ["SharedPreferences.edit()", "SharedPreferences.getString()", "SharedPreferences.putString()", "SharedPreferences.apply()", "JSONObject()", "JSONObject.optJSONObject()", "JSONObject.optLong()", "JSONObject.put()", "JSONObject.toString()", "System.currentTimeMillis()", "VideosRepository.videos", "VideosRepository"], "published": ["ProgressStore", "ProgressStore.Companion.from"], "classes": [{"name": "ProgressStore", "description": "A class for managing and persisting video playback progress data in SharedPreferences, designed for use within an Android app."}, {"name": "Progress", "description": "A data class representing the progress information of a video, including position, duration, and last played timestamp, along with a calculated percentage watched."}, {"name": "VideoProgress", "description": "A data class linking a Video object with its progress data, providing a convenience property for percentage watched."}], "methods": [{"name": "readAll", "description": "Reads the entire JSON progress data from SharedPreferences, returning an empty JSONObject if none exists or if parsing fails."}, {"name": "writeAll", "description": "Serializes the given JSONObject and saves it into SharedPreferences."}, {"name": "getProgress", "description": "Retrieves the progress for a specific video ID, returning null if not found or if the progress indicates completion."}, {"name": "setProgress", "description": "Saves the progress for a specific video ID, including position and duration, along with the current timestamp."}, {"name": "clearProgress", "description": "Removes the saved progress entry for a specific video ID."}, {"name": "listInProgress", "description": "Returns a list of in-progress videos (less than 95% watched), sorted by last played time, resolving videos through a repository."}, {"name": "from", "description": "Factory method to create a ProgressStore instance backed by SharedPreferences for a given Context."}], "calls": ["prefs.getString()", "JSONObject()", "JSONObject.optJSONObject()", "JSONObject.optLong()", "JSONObject.put()", "prefs.edit()", "edit().putString().apply()", "System.currentTimeMillis()", "videosRepo.videos.associateBy()", "all.keys()", "keys.hasNext()", "keys.next()"], "search-terms": ["ProgressStore", "SharedPreferences progress", "video progress persistence", "JSON in Android", "Kotlin data classes progress", "in-progress videos list"], "state": 2, "file_id": 31, "knowledge_revision": 80, "git_revision": "8f3bd2a44be0c20c2cdd27771c55251538083b85", "hash": "4cbd2081922b4310e74f939702eaf66c", "format-version": 4, "code-base-name": "frontend_android_tv_app", "filename": "frontend_android_tv_app/app/src/main/java/com/example/frontend_android_tv_app/data/ProgressStore.kt", "revision_history": [{"80": "8f3bd2a44be0c20c2cdd27771c55251538083b85"}]}